[Yesterday 16:49] James Dales
then edit RealisticLoadTest.html

[Yesterday 16:49] James Dales
in function EmbedReport() {.....

[Yesterday 16:50] James Dales
after:              if (loadCounter > 0)            {                var divCounter = document.getElementById('LoadReportCounter');                var avgDuration = Math.round(((((new Date()) - startTime) - (thinkTimeSeconds*loadCounter*1000)) / loadCounter)) / 1000;                divCounter.innerHTML = loadCounter                 + " refreshes<br/>"                 + avgDuration + " seconds average refresh time<br/>"                 + thinkTimeSeconds + " seconds think time";   but before the } add: CefSharp.PostMessage(divCounter.innerHTML);

[Yesterday 16:51] James Dales
then edit Run_Load_Test_Only.ps1

[Yesterday 16:51] James Dales
replace  start chrome "--user-data-dir=""ChromeProfiles\Profile$profile"" --disable-default-apps --headless --new-window ""$($reportHtmlFile)"""       with  start .\ChromeWriteBack\ChromeWriteBack """$($reportHtmlFile)"" output.txt"

[Yesterday 16:52] James Dales
now when you run it - you should get a file named output.txt which contains a new line for everything generated by the html page. This can be customised easily by editing the html to include what ever information you need. 

[Yesterday 16:59] James Dales
looks like also need to modify the start taskkill "/IM chrome.exe /FI ""USERNAME eq $env:UserName""" line

[08:17] James Dales
the summary is that we've replaced chrome.exe with a .net app with a chromium browser. It has two parameters 1) The html page to load, 2) the output file to write to. It appends to the file whatever you pass in through the CefSharp.PostMessage("text to write"); call in the html/javascript page

[08:18] James Dales
so to customise what is written to the file, modify CefSharp.PostMessage(divCounter.innerHTML); At the moment it's writing the HTML generated by   divCounter.innerHTML = loadCounter                 + " refreshes<br/>"                 + avgDuration + " seconds average refresh time<br/>"                 + thinkTimeSeconds + " seconds think time";  

